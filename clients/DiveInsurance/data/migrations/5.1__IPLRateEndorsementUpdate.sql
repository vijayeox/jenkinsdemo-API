UPDATE premium_rate_card SET premium = 396,total = 396 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2019-06-30' and end_date = '2019-07-31';
UPDATE premium_rate_card SET premium = 353,total = 353 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2019-08-01' and end_date = '2019-08-31';
UPDATE premium_rate_card SET premium = 321,total = 321 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2019-09-01' and end_date = '2019-09-30';
UPDATE premium_rate_card SET premium = 289,total = 289 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2019-10-01' and end_date = '2019-10-31';
UPDATE premium_rate_card SET premium = 256,total = 256 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2019-11-01' and end_date = '2019-11-30';
UPDATE premium_rate_card SET premium = 225,total = 225 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2019-12-01' and end_date = '2019-12-31';
UPDATE premium_rate_card SET premium = 193,total = 193 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2020-01-01' and end_date = '2020-01-31';
UPDATE premium_rate_card SET premium = 161,total = 161 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2020-02-01' and end_date = '2020-02-29';
UPDATE premium_rate_card SET premium = 128,total = 128 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2020-03-01' and end_date = '2020-03-31';
UPDATE premium_rate_card SET premium = 97,total = 97 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2020-04-01' and end_date = '2020-04-30';
UPDATE premium_rate_card SET premium = 65,total = 65 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2020-05-01' and end_date = '2020-05-31';
UPDATE premium_rate_card SET premium = 32,total = 32 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2020-06-01' and end_date = '2020-06-30';


UPDATE premium_rate_card SET premium = 396,total = 396 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2020-06-30' and end_date = '2020-07-31';
UPDATE premium_rate_card SET premium = 353,total = 353 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2020-08-01' and end_date = '2020-08-31';
UPDATE premium_rate_card SET premium = 321,total = 321 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2020-09-01' and end_date = '2020-09-30';
UPDATE premium_rate_card SET premium = 289,total = 289 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2020-10-01' and end_date = '2020-10-31';
UPDATE premium_rate_card SET premium = 256,total = 256 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2020-11-01' and end_date = '2020-11-30';
UPDATE premium_rate_card SET premium = 225,total = 225 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2020-12-01' and end_date = '2020-12-31';
UPDATE premium_rate_card SET premium = 193,total = 193 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2021-01-01' and end_date = '2021-01-31';
UPDATE premium_rate_card SET premium = 161,total = 161 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2021-02-01' and end_date = '2021-02-28';
UPDATE premium_rate_card SET premium = 128,total = 128 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2021-03-01' and end_date = '2021-03-31';
UPDATE premium_rate_card SET premium = 97,total = 97 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2021-04-01' and end_date = '2021-04-30';
UPDATE premium_rate_card SET premium = 65,total = 65 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2021-05-01' and end_date = '2021-05-31';
UPDATE premium_rate_card SET premium = 32,total = 32 WHERE `coverage` = 'Instructor' and `previous_key` = 'divemasterAssistantInstructorAssistingOnly' and product = 'Individual Professional Liability' and is_upgrade = 1 and start_date = '2021-06-01' and end_date = '2021-06-30';




DELETE from premium_rate_card WHERE  `coverage` = '9M Excess' and `previous_key` = 'excessLiabilityCoverage4000000' and product = 'Individual Professional Liability' and is_upgrade = 1 AND year in (2020,2019);

INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2019-06-30', '2019-07-31',1963,1963,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2019);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2019-08-01', '2019-08-31',1799,1799,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2019);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2019-09-01', '2019-09-30',1635,1635,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2019);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2019-10-01', '2019-10-31',1472,1472,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2019);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2019-11-01', '2019-11-30',1308,1308,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2019);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2019-12-01', '2019-12-31',1144,1144,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2019);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2020-01-01', '2020-01-31',981,981,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2019);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2020-02-01', '2020-02-28',818,818,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2019);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2020-03-01', '2020-03-31',654,654,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2019);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2020-04-01', '2020-04-30',491,491,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2019);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2020-05-01', '2020-05-31',326,326,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2019);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2020-06-01', '2020-06-30',162,162,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2019);




INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2020-06-30', '2020-07-31',1963,1963,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2020);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2020-08-01', '2020-08-31',1799,1799,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2020);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2020-09-01', '2020-09-30',1635,1635,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2020);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2020-10-01', '2020-10-31',1472,1472,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2020);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2020-11-01', '2020-11-30',1308,1308,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2020);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2020-12-01', '2020-12-31',1144,1144,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2020);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2021-01-01', '2021-01-31',981,981,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2020);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2021-02-01', '2021-02-28',818,818,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2020);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2021-03-01', '2021-03-31',654,654,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2020);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2021-04-01', '2021-04-30',491,491,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2020);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2021-05-01', '2021-05-31',326,326,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2020);
INSERT INTO `premium_rate_card` (`product`,`coverage`,`key`,`start_date`,`end_date`,`premium`,`total`,`is_upgrade`,`previous_key`,`coverage_category`,`year`) VALUES ('Individual Professional Liability', '9M Excess','excessLiabilityCoverage9000000','2021-06-01', '2021-06-30',162,162,1,'excessLiabilityCoverage4000000','EXCESS_LIABILITY',2020);


UPDATE premium_rate_card  SET `year` = CASE WHEN (MONTH(end_date) < 7) THEN
					  	(YEAR(end_date) - 1)
					ELSE 
						YEAR(end_date)
					END WHERE product != 'Dive Boat';

UPDATE premium_rate_card  SET `year` = CASE WHEN (MONTH(end_date) < 8) THEN
					  	(YEAR(end_date)-1)
					ELSE 
						YEAR(end_date)
					END WHERE product = 'Dive Boat';

